processor_resources:
  - label: "{package}_82a711aa7e18068d"
    hp_transform:
      name: "Prepare XTRANS_CR"
      input: |-
            root = this
      mapping: |-
            root = this
            let acct = this.trans.prepare.trans.debtor.AccountID
            let accname = this.trans.prepare.trans.debtor.AccountName
            let dtl = "TTXID=%s#FRMACC=%s#FRMNAME=%s#PSTDT=%s".format(this.ttx_id, $acct.string(), $accname, this.pst_dt)
            
            let comment = if this.ttx_comment != null && this.ttx_comment != "" {
                "%s#COMMENT=%s".format($dtl, this.ttx_comment)
            } else {
                $dtl
            }
            
            root.comment = "%s#CMTSEP=CMTSEP".format($comment)
            
      result_mode: merge
      output: |-
            root = this
