processor_resources:
  - label: "{package}_fd55a9f20b4011e3"
    hp_transform:
        name: "hp_transform"
        input: |
          root = this
          root.month = if this.month > 0 {
              this.month
          } else {
              now().ts_format("01", "UTC").int64()
          }
          root.year = if this.year > 0 {
              this.year
          } else {
              now().ts_format("2006", "UTC").int64()
          }
    
        mapping: |
    
          let current_year = this.year
          let current_month = this.month
    
            
          let days_in_month = if $current_month == 2 {
            if ($current_year % 4 == 0 && $current_year % 100 != 0) || ($current_year % 400 == 0) {
              29
            } else {
              28
            }
          } else if $current_month == 4 || $current_month == 6 || $current_month == 9 || $current_month == 11 {
            30
          } else {
            31
          }
    
          root = this
          root.maxDay = $days_in_month
    
        result_mode: merge
    