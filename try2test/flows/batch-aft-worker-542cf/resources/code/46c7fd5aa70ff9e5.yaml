processor_resources:
  - label: "{package}_46c7fd5aa70ff9e5"
    hp_transform:
      name: "Prepare Comment"
      input: |-
            root = this
      mapping: |-
            root = this
            let ttx_comment = this.trans.ttxComment.or("")
            let trn_cmt = "TTXID=%s#TOACC=%s#TONAME=%s#PSTDT=%s".format(this.ttx_id, this.trans.creditor.AccountID, this.trans.creditor.AccountName, "$$PSTDT$$")
            let trn_cmt = if $ttx_comment != null && $ttx_comment != "" {
                $trn_cmt + "#COMMENT=" + $ttx_comment
            }
            let trn_cmt = $trn_cmt + "#CMTSEP=CMTSEP"
            
            root.trans.debtor.trans_comment = $trn_cmt
            
            let ttx_comment = this.trans.ttxComment.or("")
            let trn_cmt = "TTXID=%s#FRMACC=%s#FRMNAME=%s#PSTDT=%s".format(this.ttx_id, this.trans.debtor.AccountID, this.trans.debtor.AccountName, "$$PSTDT$$")
            let trn_cmt = if $ttx_comment != null && $ttx_comment != "" {
                $trn_cmt + "#COMMENT=" + $ttx_comment
            }
            let trn_cmt = $trn_cmt + "#CMTSEP=CMTSEP"
            
            root.trans.creditor.trans_comment = $trn_cmt
            
            root.trans_code = this.trans.debtor.transCode.trncde.or("MOSWDT") 
      result_mode: merge
      output: |-
            root = this
