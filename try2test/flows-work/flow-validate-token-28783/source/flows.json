{"exposed":{"exposedAll":false,"exposedFormat":"standard","filterIn":{"all":false,"filter":[{"default":null,"max":0,"min":0,"name":"token","regexp":"","required":false,"type":"string","validated":false}]},"filterOut":{"all":false,"filter":[{"all":true,"max":0,"min":0,"name":"token_header","required":false,"type":"map","validated":false},{"all":true,"max":0,"min":0,"name":"token_payload","required":false,"type":"map","validated":false}]},"useFilterIn":true,"useFilterOut":true},"header":{"input":[],"output":[]},"mainFlow":{"customBenthosInOut":false,"customBenthosInputs":"","customBenthosOutputs":"","exposed":{"exposedAll":false,"exposedFormat":"standard","filterIn":{"all":false,"filter":[{"default":null,"max":0,"min":0,"name":"token","regexp":"","required":false,"type":"string","validated":false}]},"filterOut":{"all":false,"filter":[{"all":true,"max":0,"min":0,"name":"token_header","required":false,"type":"map","validated":false},{"all":true,"max":0,"min":0,"name":"token_payload","required":false,"type":"map","validated":false}]},"useFilterIn":true,"useFilterOut":true},"flowId":"de9f5d6922628783","flowName":"flow-validate-token","flow_name":"flow-validate-token-28783","header":{"input":[],"output":[]},"isSubflow":true,"nodes":[{"action":"start","advanceCode":"","changed":false,"color":"#ffffff","desc":"","dirty":false,"display":"Start","foundIt":false,"h":30,"id":"52e8c70785f341a3","ignoreNode":false,"inputs":0,"l":true,"name":"Start","nextNodes":[{"cond":"success","id":"4c997e25c80a7e0b","next":true}],"outputs":1,"processId":"1739876305865833628","processName":"flow-validate-token-1739876305865833628","resize":false,"rules":[{"cond":""}],"scopeId":"de9f5d6922628783","scopeType":"mainFlow","type":"start","useFilterIn":false,"useFilterOut":false,"uuid":"","valid":true,"validationErrors":[],"vertical":true,"w":30,"wires":[["4c997e25c80a7e0b"]],"x":671.5,"y":99,"z":"de9f5d6922628783"},{"action":"define","autoInit":true,"borderColor":"#3FADB5","borderLineSize":"2","changed":false,"code":"","color":"#ffffff","desc":"ประกาศ Input/Output","dirty":false,"display":"Define","endNode":false,"exception":"","filterIn":[{"all":true,"default":"{}","max":0,"min":0,"name":"token_payload","notEmpty":true,"required":false,"type":"map","validated":false},{"default":"aBcDeFgHiJkLmNoPqRsTuVwXyZ#$0123","max":0,"min":0,"name":"fix_key_01","regexp":"","required":false,"type":"string","validated":false},{"default":"","max":0,"min":0,"name":"token","regexp":"","required":false,"type":"string","validated":false},{"all":true,"default":"{}","max":0,"min":0,"name":"token_header","notEmpty":true,"required":false,"type":"map","validated":false}],"filterOut":[{"all":true,"default":"{}","max":0,"min":0,"name":"token_payload","notEmpty":true,"required":false,"type":"map","validated":false},{"default":"aBcDeFgHiJkLmNoPqRsTuVwXyZ#$0123","max":0,"min":0,"name":"fix_key_01","regexp":"","required":false,"type":"string","validated":false},{"default":"","max":0,"min":0,"name":"token","regexp":"","required":false,"type":"string","validated":false},{"all":true,"default":"{}","max":0,"min":0,"name":"token_header","notEmpty":true,"required":false,"type":"map","validated":false}],"flipNode":false,"foundIt":false,"h":65,"headerTextColor":"#999696","headerTextSize":"14","id":"4c997e25c80a7e0b","ignoreNode":false,"inactiveNode":false,"input":[{"children":[],"defaultValue":null,"expanded":true,"id":"07851ca0c6339734","input":true,"label":"token_payload","max":0,"min":0,"name":"token_payload","output":true,"regexp":"","required":false,"selected":true,"sublabel":"map","type":"map","validated":false},{"children":null,"defaultValue":"aBcDeFgHiJkLmNoPqRsTuVwXyZ#$0123","expanded":true,"id":"3a95109d9b9edb19","input":true,"label":"fix_key_01","max":0,"min":0,"name":"fix_key_01","output":true,"regexp":"","required":false,"selected":true,"sublabel":"string","type":"string","validated":false},{"children":null,"defaultValue":"","expanded":true,"id":"40eb4d0eac1b3210","input":true,"label":"token","max":0,"min":0,"name":"token","output":true,"regexp":"","required":false,"selected":true,"sublabel":"string","type":"string","validated":false},{"children":[],"defaultValue":null,"expanded":true,"id":"0fdabd674a331a74","input":true,"label":"token_header","max":0,"min":0,"name":"token_header","output":true,"regexp":"","required":false,"selected":true,"sublabel":"map","type":"map","validated":false}],"inputJson":"{\n    \"fix_key_01\": \"aBcDeFgHiJkLmNoPqRsTuVwXyZ#$0123\",\n    \"token\": \"\",\n    \"token_header\": {},\n    \"token_payload\": {}\n}","inputs":1,"l":true,"mainTextColor":"#333333","mainTextSize":"14","name":"Define In/Out","nextNodes":[{"cond":"success","id":"2115f74c603bfb76","next":true}],"output":[{"children":[],"defaultValue":null,"expanded":true,"id":"07851ca0c6339734","input":true,"label":"token_payload","max":0,"min":0,"name":"token_payload","output":true,"regexp":"","required":false,"selected":true,"sublabel":"map","type":"map","validated":false},{"children":null,"defaultValue":"aBcDeFgHiJkLmNoPqRsTuVwXyZ#$0123","expanded":true,"id":"3a95109d9b9edb19","input":true,"label":"fix_key_01","max":0,"min":0,"name":"fix_key_01","output":true,"regexp":"","required":false,"selected":true,"sublabel":"string","type":"string","validated":false},{"children":null,"defaultValue":"","expanded":true,"id":"40eb4d0eac1b3210","input":true,"label":"token","max":0,"min":0,"name":"token","output":true,"regexp":"","required":false,"selected":true,"sublabel":"string","type":"string","validated":false},{"children":[],"defaultValue":null,"expanded":true,"id":"0fdabd674a331a74","input":true,"label":"token_header","max":0,"min":0,"name":"token_header","output":true,"regexp":"","required":false,"selected":true,"sublabel":"map","type":"map","validated":false}],"outputs":1,"processId":"1739876305865833628","processName":"flow-validate-token-1739876305865833628","resize":false,"rules":[{"cond":"success"}],"sampleResult":"{\n    \"fix_key_01\": \"aBcDeFgHiJkLmNoPqRsTuVwXyZ#$0123\",\n    \"token\": \"\",\n    \"token_header\": {},\n    \"token_payload\": {}\n}","scopeId":"de9f5d6922628783","scopeType":"mainFlow","skeletonConfig":"### Fix Parameter ### \n# {{.type}}\n# {{.desc}}\n# {{.autoInit}}\n# {{.id}}\n# {{.name}}\n# {{.exception}}\n# {{.display}}\n# {{.moved}}\n\n### Databus Parameter ### \n#{}\n","type":"define","useFilterIn":false,"useFilterOut":false,"valid":true,"validationErrors":[],"vertical":true,"w":150,"wires":[["2115f74c603bfb76"]],"x":671.5,"y":211,"z":"de9f5d6922628783"},{"action":"code","borderColor":"#3FADB5","borderLineSize":"2","changed":false,"code":"hp_transform:\n    name: \"Convert\"\n    input: |\n        root = this\n\n    mapping: |\n        root = {}\n        root.tkDecrypted = this.token.gcm_decode(this.fix_key_01.string(), this.token.string(), -1)\n\n    result_mode: merge \n    \n    output: |\n        root = {}\n        root.tkArr = this.tkDecrypted.split(\".\")\n    \n    ","color":"#ffffff","desc":"เปลี่ยนให้เป็น JWT Token","dirty":false,"display":"Code","endNode":false,"exception":"","filterIn":[],"filterOut":[],"flipNode":false,"foundIt":false,"h":65,"headerTextColor":"#999696","headerTextSize":"14","id":"2115f74c603bfb76","ignoreNode":false,"inactiveNode":false,"input":[],"inputJson":"{}","inputs":1,"isAdvance":true,"l":true,"mainTextColor":"#333333","mainTextSize":"14","name":"To JWT Token","nextNodes":[{"cond":"success","id":"d86b3ee5a75f1126","next":true}],"output":[],"outputs":1,"processId":"1739876305865833628","processName":"flow-validate-token-1739876305865833628","resize":false,"rules":[{"cond":"success"}],"sampleResult":"{}","scopeId":"de9f5d6922628783","scopeType":"mainFlow","skeletonConfig":"### Fix Parameter ### \n# {{.exception}}\n# {{.desc}}\n# {{.display}}\n# {{.id}}\n# {{.type}}\n# {{.code}}\n# {{.uuid}}\n# {{.name}}\n# {{.moved}}\n\n### Databus Parameter ### \n#{}\n","type":"code","useFilterIn":false,"useFilterOut":false,"uuid":"","valid":true,"validationErrors":[],"vertical":true,"w":160,"wires":[["d86b3ee5a75f1126"]],"x":672.5,"y":330,"z":"de9f5d6922628783"},{"action":"code","borderColor":"#3FADB5","borderLineSize":"2","changed":false,"code":"hp_transform:\n    name: \"Convert\"\n    input: |\n        root = this\n\n    mapping: |\n        root = {}\n        root.header = this.tkArr.index(0).decode(\"base64\")\n        root.payload = this.tkArr.index(1).decode(\"base64\")\n\n    result_mode: merge  \n    \n    output: |\n        root = {}\n        root.token_header = this.header.parse_json()\n        root.token_payload = this.payload.parse_json()\n    ","color":"#ffffff","desc":"แปลง token เป็นข้อมูลที่อ่านรู้เรื่อง","dirty":false,"display":"Code","endNode":false,"exception":"","filterIn":[],"filterOut":[],"flipNode":false,"foundIt":false,"h":65,"headerTextColor":"#999696","headerTextSize":"14","id":"d2010b915b280273","ignoreNode":false,"inactiveNode":false,"input":[],"inputJson":"{}","inputs":1,"isAdvance":true,"l":true,"mainTextColor":"#333333","mainTextSize":"14","name":"Token to Data","nextNodes":[{"cond":"success","id":"34725811f261bc2b","next":true}],"output":[],"outputs":1,"processId":"1739876305865833628","processName":"flow-validate-token-1739876305865833628","resize":false,"rules":[{"cond":"success"}],"sampleResult":"{}","scopeId":"de9f5d6922628783","scopeType":"mainFlow","skeletonConfig":"### Fix Parameter ### \n# {{.exception}}\n# {{.desc}}\n# {{.display}}\n# {{.id}}\n# {{.type}}\n# {{.code}}\n# {{.uuid}}\n# {{.name}}\n# {{.moved}}\n\n### Databus Parameter ### \n#{}\n","type":"code","useFilterIn":false,"useFilterOut":false,"uuid":"","valid":true,"validationErrors":[],"vertical":true,"w":160,"wires":[["34725811f261bc2b"]],"x":796,"y":617,"z":"de9f5d6922628783"},{"action":"decision","borderColor":"#3FADB5","borderLineSize":"2","changed":false,"code":"","color":"#ffffff","decision-field-dataBus-container-div":"","desc":"ตรวจสอบ JWT Token ว่าถุกหรือไม่","dirty":false,"display":"Decision","endNode":false,"exception":"","filterIn":[],"filterOut":[],"flipNode":false,"foundIt":false,"h":65,"headerTextColor":"#999696","headerTextSize":"14","id":"d86b3ee5a75f1126","ignoreNode":false,"inactiveNode":false,"input":[],"inputs":1,"l":true,"mainTextColor":"#333333","mainTextSize":"14","name":"Check JWT Token","nextNodes":[{"cond":"tkArr.length() \u003c 2","id":"1d30b1a4a6f2bfad","next":true},{"cond":"else","id":"d2010b915b280273","next":true}],"output":[],"outputs":2,"postEzCode":"","preEzCode":"","processId":"1739876305865833628","processName":"flow-validate-token-1739876305865833628","resize":false,"rule-container":"","rules":[{"cond":"tkArr.length() \u003c 2"},{"cond":"else"}],"scopeId":"de9f5d6922628783","scopeType":"mainFlow","skeletonConfig":"### Fix Parameter ### \n# {{.preEzCode}}\n# {{.uuid}}\n# {{.desc}}\n# {{.id}}\n# {{.type}}\n# {{.exception}}\n# {{.postEzCode}}\n# {{.display}}\n# {{.moved}}\n# {{.name}}\n\n### Databus Parameter ### \n#{}\n","type":"decision","useFilterIn":false,"useFilterOut":false,"uuid":"","valid":true,"validationErrors":[],"w":180,"wires":[["1d30b1a4a6f2bfad"],["d2010b915b280273"]],"x":672.5,"y":453,"z":"de9f5d6922628783"},{"action":"exception","borderColor":"#3FADB5","borderLineSize":"2","changed":false,"code":"let error_code = \"400\"\nlet error_message = \"Bad Request\"\n","color":"#FFAAAA","desc":"ตรวจสอบ ​JWT Token","dirty":false,"display":"Exception","endNode":false,"exceptionCode":"$400","exceptionType":"HTTP","flipNode":false,"foundIt":false,"h":65,"headerTextColor":"#999696","headerTextSize":"14","id":"1d30b1a4a6f2bfad","ignoreNode":false,"inactiveNode":false,"inputs":1,"key":"","l":true,"mainTextColor":"#333333","mainTextSize":"14","message":"$error_message","name":"Exception","nextNodes":[],"outputs":0,"processId":"1739876305865833628","processName":"flow-validate-token-1739876305865833628","resize":false,"scopeId":"de9f5d6922628783","scopeType":"mainFlow","select-exceptionCode":400,"skeletonConfig":"### Fix Parameter ### \n# {{.desc}}\n# {{.name}}\n# {{.moved}}\n# {{.id}}\n# {{.exceptionCode}}\n# {{.uuid}}\n# {{.exceptionType}}\n# {{.message}}\n# {{.display}}\n# {{.type}}\n# {{.key}}\n\n### Databus Parameter ### \n#{}\n","textfield-exceptionCode":400,"type":"exception","useFilterIn":false,"useFilterOut":false,"uuid":"","valid":true,"validationErrors":[],"w":150,"wires":[],"x":548.5,"y":618,"z":"de9f5d6922628783"},{"action":"end","advanceCode":"","changed":false,"color":"#ffffff","desc":"","dirty":false,"display":"End","foundIt":false,"h":30,"id":"34725811f261bc2b","ignoreNode":false,"inputs":1,"l":true,"name":"End","nextNodes":[],"outPort":0,"outputs":0,"processId":"1739876305865833628","processName":"flow-validate-token-1739876305865833628","resize":false,"scopeId":"de9f5d6922628783","scopeType":"mainFlow","type":"end","useFilterIn":false,"useFilterOut":false,"uuid":"","valid":true,"validationErrors":[],"w":30,"wires":[],"x":666.5,"y":775,"z":"de9f5d6922628783"},{"id":"de9f5d6922628783","ignoreNode":true,"info":"","label":"flow-validate-token","scopeId":"de9f5d6922628783","scopeType":"mainFlow","teamSharing":"Read-Write","type":"tab"}],"output":[null],"startNodeId":"52e8c70785f341a3","transport":{"inputs":"","outputs":"","type":"YAML"}},"nodeList":{"MainFlowId":"de9f5d6922628783","MainFlowName":"flow-validate-token","Nodes":[{"Action":"","FlowId":"de9f5d6922628783","FlowName":"flow-validate-token","NodeId":"52e8c70785f341a3","NodeName":"Start","NodeType":"start","Status":"","SubflowId":"","SubflowName":"","headerIn":null,"headerOut":null},{"Action":"","FlowId":"de9f5d6922628783","FlowName":"flow-validate-token","NodeId":"4c997e25c80a7e0b","NodeName":"Define In/Out","NodeType":"define","Status":"","SubflowId":"","SubflowName":"","headerIn":null,"headerOut":null},{"Action":"","FlowId":"de9f5d6922628783","FlowName":"flow-validate-token","NodeId":"2115f74c603bfb76","NodeName":"To JWT Token","NodeType":"code","Status":"","SubflowId":"","SubflowName":"","headerIn":null,"headerOut":null},{"Action":"","FlowId":"de9f5d6922628783","FlowName":"flow-validate-token","NodeId":"d2010b915b280273","NodeName":"Token to Data","NodeType":"code","Status":"","SubflowId":"","SubflowName":"","headerIn":null,"headerOut":null},{"Action":"","FlowId":"de9f5d6922628783","FlowName":"flow-validate-token","NodeId":"d86b3ee5a75f1126","NodeName":"Check JWT Token","NodeType":"decision","Status":"","SubflowId":"","SubflowName":"","headerIn":null,"headerOut":null},{"Action":"","FlowId":"de9f5d6922628783","FlowName":"flow-validate-token","NodeId":"1d30b1a4a6f2bfad","NodeName":"Exception","NodeType":"exception","Status":"","SubflowId":"","SubflowName":"","headerIn":null,"headerOut":null},{"Action":"","FlowId":"de9f5d6922628783","FlowName":"flow-validate-token","NodeId":"34725811f261bc2b","NodeName":"End","NodeType":"end","Status":"","SubflowId":"","SubflowName":"","headerIn":null,"headerOut":null},{"Action":"","FlowId":"de9f5d6922628783","FlowName":"flow-validate-token","NodeId":"de9f5d6922628783","NodeName":"","NodeType":"tab","Status":"","SubflowId":"","SubflowName":"","headerIn":null,"headerOut":null}]}}